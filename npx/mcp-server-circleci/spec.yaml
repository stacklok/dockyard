# MCP Server CircleCI Configuration
# MCP server for CircleCI CI/CD platform operations
# Package: https://www.npmjs.com/package/@circleci/mcp-server-circleci
# Repository: https://github.com/CircleCI-Public/mcp-server-circleci
# Will build as: ghcr.io/stacklok/dockyard/npx/mcp-server-circleci:0.14.0

metadata:
  name: mcp-server-circleci
  description: "MCP server for CircleCI, enabling natural language interactions with CircleCI functionality"
  protocol: npx

spec:
  package: "@circleci/mcp-server-circleci"
  version: "0.14.2"

provenance:
  repository_uri: "https://github.com/CircleCI-Public/mcp-server-circleci"
  repository_ref: "refs/heads/main"

# Optional: Security allowlist
security:
  # Mock env vars allow security scanning without real credentials
  mock_env:
    - name: CIRCLECI_TOKEN
      value: "mock-circleci-token-for-scanning"
      description: "CircleCI API token - mock value for security scanning"
  allowed_issues:
    - code: "AITech-1.1"
      reason: "CI/CD operations require specific terminology for pipeline control (run, rollback, rerun) that may trigger prompt injection warnings"
    - code: "AITech-12.1"
      reason: "Tool descriptions contain operational instructions for CI/CD workflows (e.g., 'MUST start your response with', 'CRITICAL REQUIREMENTS') that are necessary for proper data handling and tool usage guidance"
    - code: "AITech-8.2"
      reason: "CircleCI must access private build data, configurations, and secrets while interacting with external systems for CI/CD operations"
    - code: "AITech-9.1"
      reason: "CI/CD platforms inherently perform destructive operations like canceling builds, running pipelines, and modifying configurations"
